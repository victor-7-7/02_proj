FROM node:current-alpine3.15

# Внутри контейнера создаем папку, в которой будем работать
WORKDIR /usr/src/app

# Копируем файлы из локального проекта в рабдир контейнера
COPY package*.json ./

# Установливаем в контейнер необходимые пакеты (node_modules)
RUN npm install

# Копируем файлы из локальной папки app в рабдир контейнера. 
# Локальная папка node_modules будет проигнорирована ввиду 
# файла .dockerignore
COPY . .

# Билдим статику для фронтенда
RUN npm run build
# Устанавливаем пакет статического сервера
RUN npm install -g serve

#-----------------------------------------------------------
# Без компоуза с одним докером мы бы конфигурировали аппу здесь. 
# Открываем изнутри контейнера порт 3000 наружу. Аппа внутри 
# контейнера будет прослушивать его, поскольку имеет код 
# app.listen(3000, () => {
#    console.log('Started api service');
# });
# EXPOSE 3000
# Запускаем нодовскую аппу в контейнере
# CMD ["node", "run start"]
#-----------------------------------------------------------
# А с компоузом мы делаем конфиг в docker-compose.yml


